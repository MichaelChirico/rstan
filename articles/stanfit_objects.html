<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accessing the contents of a stanfit object • rstan</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Accessing the contents of a stanfit object">
<meta property="og:description" content="rstan">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.26.24</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot" class="external-link">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan" class="external-link">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo" class="external-link">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred" class="external-link">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org" class="external-link">Stan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/mcmc_stan" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/rstan" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Accessing the contents of a stanfit object</h1>
                        <h4 data-toc-skip class="author">Stan
Development Team</h4>
            
            <h4 data-toc-skip class="date">2023-09-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/rstan/blob/HEAD/vignettes/stanfit_objects.Rmd" class="external-link"><code>vignettes/stanfit_objects.Rmd</code></a></small>
      <div class="hidden name"><code>stanfit_objects.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates how to access most of data stored in a
stanfit object. A stanfit object (an object of class
<code>"stanfit"</code>) contains the output derived from fitting a Stan
model using Markov chain Monte Carlo or one of Stan’s variational
approximations (meanfield or full-rank). Throughout the document we’ll
use the stanfit object obtained from fitting the Eight Schools example
model:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstan/">rstan</a></span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stan_demo.html">stan_demo</a></span><span class="op">(</span><span class="st">"eight_schools"</span>, refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "stanfit"
attr(,"package")
[1] "rstan"</code></pre>
<div class="section level2">
<h2 id="posterior-draws">Posterior draws<a class="anchor" aria-label="anchor" href="#posterior-draws"></a>
</h2>
<p>There are several functions that can be used to access the draws from
the posterior distribution stored in a stanfit object. These are
<code>extract</code>, <code>as.matrix</code>,
<code>as.data.frame</code>, and <code>as.array</code>, each of which
returns the draws in a different format.</p>
<p><br></p>
<div class="section level4">
<h4 id="extract">extract()<a class="anchor" aria-label="anchor" href="#extract"></a>
</h4>
<p>The <code>extract</code> function (with its default arguments)
returns a list with named components corresponding to the model
parameters.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_of_draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stanfit-method-extract.html">extract</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">list_of_draws</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "mu"    "tau"   "eta"   "theta" "lp__" </code></pre>
<p>In this model the parameters <code>mu</code> and <code>tau</code> are
scalars and <code>theta</code> is a vector with eight elements. This
means that the draws for <code>mu</code> and <code>tau</code> will be
vectors (with length equal to the number of post-warmup iterations times
the number of chains) and the draws for <code>theta</code> will be a
matrix, with each column corresponding to one of the eight
components:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">list_of_draws</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1]  8.158595  7.880213 14.086734  1.992156  7.283674 15.916944</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">list_of_draws</span><span class="op">$</span><span class="va">tau</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 11.5467890  3.1630415  8.9115022  0.7782174  3.3101477  4.7479295</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">list_of_draws</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span></span></code></pre></div>
<pre><code>          
iterations       [,1]      [,2]      [,3]      [,4]       [,5]      [,6]
      [1,] 28.4498512 13.812518 27.569254  9.143677  15.323212 18.270046
      [2,]  9.4066896  9.594654  5.298375  5.605437   7.827925  6.899140
      [3,] 14.0018236 18.129483 27.020226 15.679345 -10.604681 -3.521928
      [4,]  0.8767176  2.344286  1.289285  1.479599   1.725346  2.312681
      [5,]  4.9130196  5.703014  9.707277  9.056205   4.472401  9.378470
      [6,] 15.0274075  5.513797 16.454255 14.355015  21.074407  9.402672
          
iterations      [,7]      [,8]
      [1,]  1.479218 15.372751
      [2,] 14.243631  1.350251
      [3,] 25.729921 12.187797
      [4,]  2.758654  2.501818
      [5,]  7.335756  9.839808
      [6,] 16.360368 11.608590</code></pre>
<p><br></p>
</div>
<div class="section level4">
<h4 id="as-matrix-as-data-frame-as-array">as.matrix(), as.data.frame(), as.array()<a class="anchor" aria-label="anchor" href="#as-matrix-as-data-frame-as-array"></a>
</h4>
<p>The <code>as.matrix</code>, <code>as.data.frame</code>, and
<code>as.array</code> functions can also be used to retrieve the
posterior draws from a stanfit object:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">matrix_of_draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">matrix_of_draws</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] "mu"       "tau"      "eta[1]"   "eta[2]"   "eta[3]"   "eta[4]"  
 [7] "eta[5]"   "eta[6]"   "eta[7]"   "eta[8]"   "theta[1]" "theta[2]"
[13] "theta[3]" "theta[4]" "theta[5]" "theta[6]" "theta[7]" "theta[8]"
[19] "lp__"    </code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_of_draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df_of_draws</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] "mu"       "tau"      "eta[1]"   "eta[2]"   "eta[3]"   "eta[4]"  
 [7] "eta[5]"   "eta[6]"   "eta[7]"   "eta[8]"   "theta[1]" "theta[2]"
[13] "theta[3]" "theta[4]" "theta[5]" "theta[6]" "theta[7]" "theta[8]"
[19] "lp__"    </code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">array_of_draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">as.array</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">array_of_draws</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>$iterations
NULL

$chains
[1] "chain:1" "chain:2" "chain:3" "chain:4"

$parameters
 [1] "mu"       "tau"      "eta[1]"   "eta[2]"   "eta[3]"   "eta[4]"  
 [7] "eta[5]"   "eta[6]"   "eta[7]"   "eta[8]"   "theta[1]" "theta[2]"
[13] "theta[3]" "theta[4]" "theta[5]" "theta[6]" "theta[7]" "theta[8]"
[19] "lp__"    </code></pre>
<p>The <code>as.matrix</code> and <code>as.data.frame</code> methods
essentially return the same thing except in matrix and data frame form,
respectively. The <code>as.array</code> method returns the draws from
each chain separately and so has an additional dimension:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">matrix_of_draws</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">df_of_draws</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">array_of_draws</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 4000   19
[1] 4000   19
[1] 1000    4   19</code></pre>
<p>By default all of the functions for retrieving the posterior draws
return the draws for <em>all</em> parameters (and generated quantities).
The optional argument <code>pars</code> (a character vector) can be used
if only a subset of the parameters is desired, for example:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_and_theta1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fit</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"theta[1]"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mu_and_theta1</span><span class="op">)</span></span></code></pre></div>
<pre><code>          parameters
iterations        mu  theta[1]
      [1,] 12.822571 15.297461
      [2,]  9.392738 11.477776
      [3,]  6.081793  5.126646
      [4,]  7.517083  7.173908
      [5,]  8.536018 24.396196
      [6,] 12.179750  9.792373</code></pre>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="posterior-summary-statistics-and-convergence-diagnostics">Posterior summary statistics and convergence diagnostics<a class="anchor" aria-label="anchor" href="#posterior-summary-statistics-and-convergence-diagnostics"></a>
</h2>
<p>Summary statistics are obtained using the <code>summary</code>
function. The object returned is a list with two components:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_summary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "summary"   "c_summary"</code></pre>
<p>In <code>fit_summary$summary</code> all chains are merged whereas
<code>fit_summary$c_summary</code> contains summaries for each chain
individually. Typically we want the summary for all chains merged, which
is what we’ll focus on here.</p>
<p>The summary is a matrix with rows corresponding to parameters and
columns to the various summary quantities. These include the posterior
mean, the posterior standard deviation, and various quantiles computed
from the draws. The <code>probs</code> argument can be used to specify
which quantiles to compute and <code>pars</code> can be used to specify
a subset of parameters to include in the summary.</p>
<p>For models fit using MCMC, also included in the summary are the Monte
Carlo standard error (<code>se_mean</code>), the effective sample size
(<code>n_eff</code>), and the R-hat statistic (<code>Rhat</code>).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_summary</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></code></pre></div>
<pre><code>                 mean    se_mean        sd        2.5%         25%
mu         7.88112638 0.11886981 5.1400521  -2.1874849   4.5862578
tau        6.45264757 0.14793579 5.6059239   0.2438317   2.4334292
eta[1]     0.36243921 0.01534587 0.9281426  -1.4718403  -0.2628066
eta[2]     0.01886754 0.01341454 0.8668440  -1.6882721  -0.5607231
eta[3]    -0.16085954 0.01555826 0.9356425  -1.9333095  -0.8083447
eta[4]    -0.02161591 0.01528133 0.8929354  -1.7499464  -0.6141818
eta[5]    -0.37753813 0.01462871 0.8545046  -2.0589638  -0.9574080
eta[6]    -0.21296151 0.01452506 0.9063613  -1.9594580  -0.8191162
eta[7]     0.34961133 0.01448700 0.9062853  -1.5323017  -0.2308520
eta[8]     0.06684927 0.01482872 0.9363868  -1.8603479  -0.5547307
theta[1]  11.14131968 0.15570247 8.2709442  -2.6106520   6.0436778
theta[2]   7.95859334 0.09304677 6.2312790  -4.3871431   3.9185803
theta[3]   6.41387106 0.12989815 7.6799788 -11.0819752   2.2992616
theta[4]   7.60884404 0.10202428 6.5850034  -6.0371411   3.5611151
theta[5]   4.94911661 0.10464727 6.2732871  -9.3887854   1.2949771
theta[6]   6.20658841 0.10725834 6.8355631  -8.3747947   2.1210493
theta[7]  10.60462091 0.12250274 6.6961993  -0.6030978   6.1064082
theta[8]   8.47344823 0.14454695 8.0284266  -7.4842285   3.8346619
lp__     -39.58643914 0.06863020 2.6044560 -45.5215532 -41.1448851
                   50%         75%      97.5%    n_eff      Rhat
mu         7.787782492  11.1431031  18.388916 1869.786 0.9995491
tau        5.088594901   8.9653879  20.987474 1435.978 1.0029909
eta[1]     0.373245147   0.9923146   2.129075 3658.022 1.0004282
eta[2]    -0.004334584   0.5905507   1.717842 4175.711 0.9997220
eta[3]    -0.181754770   0.4567332   1.691041 3616.576 1.0000403
eta[4]    -0.024249343   0.5771657   1.765282 3414.425 0.9997084
eta[5]    -0.390550370   0.1578636   1.371040 3412.063 0.9995389
eta[6]    -0.217677125   0.3668237   1.612039 3893.739 0.9999304
eta[7]     0.357785797   0.9556616   2.131229 3913.571 0.9998760
eta[8]     0.095595700   0.7077347   1.812303 3987.523 1.0010843
theta[1]   9.983158055  15.3383770  30.678479 2821.754 1.0005669
theta[2]   7.915022564  11.7913960  20.958119 4484.890 0.9995185
theta[3]   6.792102722  10.9150764  21.121257 3495.539 1.0018001
theta[4]   7.645471822  11.8346127  20.775881 4165.862 0.9996712
theta[5]   5.393538462   9.1365562  16.129178 3593.640 0.9997582
theta[6]   6.585073185  10.5238483  19.289236 4061.500 0.9999494
theta[7]   9.962639496  14.5929002  25.730154 2987.894 1.0005973
theta[8]   8.139927461  12.8687269  25.952480 3084.914 1.0010763
lp__     -39.331531763 -37.7405538 -35.308693 1440.136 1.0009663</code></pre>
<p>If, for example, we wanted the only quantiles included to be 10% and
90%, and for only the parameters included to be <code>mu</code> and
<code>tau</code>, we would specify that like this:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_tau_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"tau"</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mu_tau_summary</span><span class="op">)</span></span></code></pre></div>
<pre><code>        mean   se_mean       sd       10%      90%    n_eff      Rhat
mu  7.881126 0.1188698 5.140052 1.5573901 14.50957 1869.786 0.9995491
tau 6.452648 0.1479358 5.605924 0.9572862 13.24043 1435.978 1.0029909</code></pre>
<p>Since <code>mu_tau_summary</code> is a matrix we can pull out columns
using their names:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_tau_80pct</span> <span class="op">&lt;-</span> <span class="va">mu_tau_summary</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10%"</span>, <span class="st">"90%"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mu_tau_80pct</span><span class="op">)</span></span></code></pre></div>
<pre><code>          10%      90%
mu  1.5573901 14.50957
tau 0.9572862 13.24043</code></pre>
<p><br></p>
</div>
<div class="section level2">
<h2 id="sampler-diagnostics">Sampler diagnostics<a class="anchor" aria-label="anchor" href="#sampler-diagnostics"></a>
</h2>
<p>For models fit using MCMC the stanfit object will also contain the
values of parameters used for the sampler. The
<code>get_sampler_params</code> function can be used to access this
information.</p>
<p>The object returned by <code>get_sampler_params</code> is a list with
one component (a matrix) per chain. Each of the matrices has number of
columns corresponding to the number of sampler parameters and the column
names provide the parameter names. The optional argument inc_warmup
(defaulting to <code>TRUE</code>) indicates whether to include the
warmup period.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sampler_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stanfit-class.html">get_sampler_params</a></span><span class="op">(</span><span class="va">fit</span>, inc_warmup <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sampler_params_chain1</span> <span class="op">&lt;-</span> <span class="va">sampler_params</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sampler_params_chain1</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "accept_stat__" "stepsize__"    "treedepth__"   "n_leapfrog__" 
[5] "divergent__"   "energy__"     </code></pre>
<p>To do things like calculate the average value of
<code>accept_stat__</code> for each chain (or the maximum value of
<code>treedepth__</code> for each chain if using the NUTS algorithm,
etc.) the <code>sapply</code> function is useful as it will apply the
same function to each component of <code>sampler_params</code>:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_accept_stat_by_chain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sampler_params</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="st">"accept_stat__"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mean_accept_stat_by_chain</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.8514222 0.8829814 0.8919147 0.8416380</code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_treedepth_by_chain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sampler_params</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="st">"treedepth__"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">max_treedepth_by_chain</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 4 5 4 4</code></pre>
<p><br></p>
</div>
<div class="section level2">
<h2 id="model-code">Model code<a class="anchor" aria-label="anchor" href="#model-code"></a>
</h2>
<p>The Stan program itself is also stored in the stanfit object and can
be accessed using <code>get_stancode</code>:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">code</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stanfit-class.html">get_stancode</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>The object <code>code</code> is a single string and is not very
intelligible when printed:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">code</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "data {\n  int&lt;lower=0&gt; J;          // number of schools\n  real y[J];               // estimated treatment effects\n  real&lt;lower=0&gt; sigma[J];  // s.e. of effect estimates\n}\nparameters {\n  real mu;\n  real&lt;lower=0&gt; tau;\n  vector[J] eta;\n}\ntransformed parameters {\n  vector[J] theta;\n  theta = mu + tau * eta;\n}\nmodel {\n  target += normal_lpdf(eta | 0, 1);\n  target += normal_lpdf(y | theta, sigma);\n}"
attr(,"model_name2")
[1] "schools"</code></pre>
<p>A readable version can be printed using <code>cat</code>:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">code</span><span class="op">)</span></span></code></pre></div>
<pre><code>data {
  int&lt;lower=0&gt; J;          // number of schools
  real y[J];               // estimated treatment effects
  real&lt;lower=0&gt; sigma[J];  // s.e. of effect estimates
}
parameters {
  real mu;
  real&lt;lower=0&gt; tau;
  vector[J] eta;
}
transformed parameters {
  vector[J] theta;
  theta = mu + tau * eta;
}
model {
  target += normal_lpdf(eta | 0, 1);
  target += normal_lpdf(y | theta, sigma);
}</code></pre>
<p><br></p>
</div>
<div class="section level2">
<h2 id="initial-values">Initial values<a class="anchor" aria-label="anchor" href="#initial-values"></a>
</h2>
<p>The <code>get_inits</code> function returns initial values as a list
with one component per chain. Each component is itself a (named) list
containing the initial values for each parameter for the corresponding
chain:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stanfit-class.html">get_inits</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">inits_chain1</span> <span class="op">&lt;-</span> <span class="va">inits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">inits_chain1</span><span class="op">)</span></span></code></pre></div>
<pre><code>$mu
[1] 1.830195

$tau
[1] 1.48977

$eta
[1] -1.9644185  1.2900084 -0.5047292  1.3198299 -1.9966361 -1.9750366  1.8860891
[8]  1.8957488

$theta
[1] -1.096337  3.752011  1.078264  3.796438 -1.144334 -1.112156  4.640034
[8]  4.654425</code></pre>
<p><br></p>
</div>
<div class="section level2">
<h2 id="prng-seed">(P)RNG seed<a class="anchor" aria-label="anchor" href="#prng-seed"></a>
</h2>
<p>The <code>get_seed</code> function returns the (P)RNG seed as an
integer:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/stanfit-class.html">get_seed</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 1466491891</code></pre>
<p><br></p>
</div>
<div class="section level2">
<h2 id="warmup-and-sampling-times">Warmup and sampling times<a class="anchor" aria-label="anchor" href="#warmup-and-sampling-times"></a>
</h2>
<p>The <code>get_elapsed_time</code> function returns a matrix with the
warmup and sampling times for each chain:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/stanfit-class.html">get_elapsed_time</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>        warmup sample
chain:1  0.050  0.042
chain:2  0.047  0.051
chain:3  0.051  0.049
chain:4  0.046  0.043</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jiqiang Guo, Jonah Gabry, Ben Goodrich, Andrew Johnson, Sebastian Weber.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
