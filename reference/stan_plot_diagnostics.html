<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>RStan Diagnostic plots — Diagnostic plots • rstan</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="RStan Diagnostic plots — Diagnostic plots"><meta property="og:description" content="Diagnostic plots for HMC and NUTS using ggplot2."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.26.24</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot" class="external-link">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan" class="external-link">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo" class="external-link">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred" class="external-link">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul></li>
<li>
  <a href="https://mc-stan.org" class="external-link">Stan</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/mcmc_stan" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/rstan" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>RStan Diagnostic plots</h1>
    
    <div class="hidden name"><code>stan_plot_diagnostics.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Diagnostic plots for HMC and NUTS using ggplot2.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stan_diag</span><span class="op">(</span><span class="va">object</span>, </span>
<span>            information <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample"</span>,<span class="st">"stepsize"</span>, <span class="st">"treedepth"</span>,<span class="st">"divergence"</span><span class="op">)</span>, </span>
<span>            chain <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="fu">stan_par</span><span class="op">(</span><span class="va">object</span>, <span class="va">par</span>, chain <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">stan_rhat</span><span class="op">(</span><span class="va">object</span>, <span class="va">pars</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="fu">stan_ess</span><span class="op">(</span><span class="va">object</span>, <span class="va">pars</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="fu">stan_mcse</span><span class="op">(</span><span class="va">object</span>, <span class="va">pars</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>A stanfit or stanreg object.</p></dd>

  
  <dt>information</dt>
<dd><p>The information to be contained in the diagnostic plot.</p></dd>

  
  <dt>par,pars</dt>
<dd><p>The name of a single scalar parameter (<code>par</code>) or 
    one or more parameter names (<code>pars</code>).</p></dd>

  
  <dt>chain</dt>
<dd><p>If <code>chain=0</code> (the default) all chains are combined.
    Otherwise the plot for <code>chain</code> is overlaid on the plot for all chains
    combined.</p></dd>

  
  <dt>...</dt>
<dd><p>For <code>stan_diag</code> and <code>stan_par</code>, optional arguments to 
    <code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">arrangeGrob</a></code>. For <code>stan_rhat</code>, <code>stan_ess</code>, 
    and <code>stan_mcse</code>, optional arguments to <code>stat_bin</code> in the 
    <span class="pkg">ggplot2</span> package.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>For <code>stan_diag</code> and <code>stan_par</code>, a list containing the ggplot objects for 
  each of the displayed plots. For <code>stan_rhat</code>, <code>stan_ess</code>, 
  and <code>stan_mcse</code>, a single ggplot object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p></p><dl><dt><code>stan_rhat</code>,<code>stan_ess</code>,<code>stan_mcse</code></dt>
<dd><p>Respectively, 
  these plots show the 
  distribution of the Rhat statistic, the ratio of effective sample size to 
  total sample size, and the ratio of Monte Carlo standard error
  to posterior standard deviation for the estimated parameters. These 
  plots are not intended to identify individual parameters, but rather to allow
  for quickly identifying if the estimated values of these quantities are
  desireable for all parameters.</p></dd>

  <dt><code>stan_par</code></dt>
<dd><p>Calling <code>stan_par</code> generates three plots: 
  (i) a scatterplot of <code>par</code> vs. the accumulated log-posterior (<code>lp__</code>), 
  (ii) a scatterplot of <code>par</code> vs. the average Metropolis acceptance rate 
  (<code>accept_stat</code>), and 
  (iii) a violin plot showing the distribution of <code>par</code> at each of the 
  sampled step sizes (one per chain).
  For the scatterplots, red points are superimposed to indicate which 
  (if any) iterations encountered a divergent transition. Yellow points indicate 
  a transition that hit the maximum treedepth rather than terminated its 
  evolution normally.</p></dd>

  <dt><code>stan_diag</code></dt>
<dd><p>The <code>information</code> argument is used to specify which 
  plots <code>stan_diag</code> should generate:</p>  
<p></p><ul><li><p><code>information='sample'</code>Histograms of <code>lp__</code> 
      and <code>accept_stat</code>, as well as a scatterplot showing their 
      joint distribution.</p></li>
<li><p><code>information='stepsize'</code>Violin plots showing the 
      distributions of <code>lp__</code> and <code>accept_stat</code> at each of the sampled
      step sizes (one per chain).</p></li>
<li><p><code>information='treedepth'</code>Histogram of <code>treedepth</code> and 
      violin plots showing the distributions of <code>lp__</code> and 
      <code>accept_stat</code> for each value of <code>treedepth</code>.</p></li>
<li><p><code>information='divergence'</code>Violin plots showing the 
      distributions of <code>lp__</code> and <code>accept_stat</code> for iterations that
      encountered divergent transitions (<code>divergent=1</code>) and those that
      did not (<code>divergent=0</code>).</p></li>
</ul><p></p></dd>


</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>For details about the individual diagnostics and sampler parameters and their
  interpretations see the Stan Modeling Language User's Guide and Reference 
  Manual at <a href="https://mc-stan.org/documentation/" class="external-link">https://mc-stan.org/documentation/</a>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plotting-functions.html">List of RStan plotting functions</a></code>,
<code><a href="stan_plot_options.html">Plot options</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="stan_demo.html">stan_demo</a></span><span class="op">(</span><span class="st">"eight_schools"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">stan_diag</span><span class="op">(</span><span class="va">fit</span>, info <span class="op">=</span> <span class="st">'sample'</span><span class="op">)</span> <span class="co"># shows three plots together</span></span></span>
<span class="r-in"><span><span class="va">samp_info</span> <span class="op">&lt;-</span> <span class="fu">stan_diag</span><span class="op">(</span><span class="va">fit</span>, info <span class="op">=</span> <span class="st">'sample'</span><span class="op">)</span> <span class="co"># saves the three plots in a list</span></span></span>
<span class="r-in"><span><span class="va">samp_info</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="co"># access just the third plot</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">stan_diag</span><span class="op">(</span><span class="va">fit</span>, info <span class="op">=</span> <span class="st">'sample'</span>, chain <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># overlay chain 1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">stan_par</span><span class="op">(</span><span class="va">fit</span>, par <span class="op">=</span> <span class="st">"mu"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jiqiang Guo, Jonah Gabry, Ben Goodrich, Andrew Johnson, Sebastian Weber.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

